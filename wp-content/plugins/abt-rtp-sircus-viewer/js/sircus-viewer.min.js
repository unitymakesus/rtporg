!function(e,t,r){"use strict";function n(e){var r=[];return c(r,t.noop).chars(e),r.join("")}function i(e){var t={};e=e.split(",");var r;for(r=0;r<e.length;r++)t[e[r]]=!0;return t}function o(e,r){function n(e,n,o,s){if(n=t.lowercase(n),w[n])for(;c.last()&&x[c.last()];)i("",c.last());b[n]&&c.last()==n&&i("",n),(s=y[n]||!!s)||c.push(n);var u={};o.replace(d,function(e,t,r,n,i){u[t]=a(r||n||i||"")}),r.start&&r.start(n,u,s)}function i(e,n){var i,o=0;if(n=t.lowercase(n))for(o=c.length-1;o>=0&&c[o]!=n;o--);if(o>=0){for(i=c.length-1;i>=o;i--)r.end&&r.end(c[i]);c.length=o}}var o,s,c=[],S=e;for(c.last=function(){return c[c.length-1]};e;){if(s=!0,c.last()&&I[c.last()]?(e=e.replace(RegExp("(.*)<\\s*\\/\\s*"+c.last()+"[^>]*>","i"),function(e,t){return t=t.replace(h,"$1").replace(v,"$1"),r.chars&&r.chars(a(t)),""}),i("",c.last())):(0===e.indexOf("<!--")?(o=e.indexOf("--",4),o>=0&&e.lastIndexOf("-->",o)===o&&(r.comment&&r.comment(e.substring(4,o)),e=e.substring(o+3),s=!1)):m.test(e)?(o=e.match(m))&&(e=e.replace(o[0],""),s=!1):p.test(e)?(o=e.match(f))&&(e=e.substring(o[0].length),o[0].replace(f,i),s=!1):g.test(e)&&(o=e.match(l))&&(e=e.substring(o[0].length),o[0].replace(l,n),s=!1),s&&(o=e.indexOf("<"),s=0>o?e:e.substring(0,o),e=0>o?"":e.substring(o),r.chars&&r.chars(a(s)))),e==S)throw u("badparse",e);S=e}i()}function a(e){if(!e)return"";var t=F.exec(e);e=t[1];var r=t[3];return(t=t[2])&&($.innerHTML=t.replace(/</g,"&lt;"),t="textContent"in $?$.textContent:$.innerText),e+t+r}function s(e){return e.replace(/&/g,"&amp;").replace(S,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,r){var n=!1,i=t.bind(e,e.push);return{start:function(e,o,a){e=t.lowercase(e),!n&&I[e]&&(n=e),n||!0!==k[e]||(i("<"),i(e),t.forEach(o,function(n,o){var a=t.lowercase(o),c="img"===e&&"src"===a||"background"===a;!0!==A[a]||!0===T[a]&&!r(n,c)||(i(" "),i(o),i('="'),i(s(n)),i('"'))}),i(a?"/>":">"))},end:function(e){e=t.lowercase(e),n||!0!==k[e]||(i("</"),i(e),i(">")),e==n&&(n=!1)},chars:function(e){n||i(s(e))}}}var u=t.$$minErr("$sanitize"),l=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,f=/^<\s*\/\s*([\w:-]+)[^>]*>/,d=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,g=/^</,p=/^<\s*\//,h=/\x3c!--(.*?)--\x3e/g,m=/<!DOCTYPE([^>]*?)>/i,v=/<!\[CDATA\[(.*?)]]\x3e/g,S=/([^\#-~| |!])/g,y=i("area,br,col,hr,img,wbr");e=i("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),r=i("rp,rt");var b=t.extend({},r,e),w=t.extend({},e,i("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),x=t.extend({},r,i("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),I=i("script,style"),k=t.extend({},y,w,x,b),T=i("background,cite,href,longdesc,src,usemap"),A=t.extend({},T,i("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),$=document.createElement("pre"),F=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",function(){this.$get=["$$sanitizeUri",function(e){return function(t){var r=[];return o(t,c(r,function(t,r){return!/^unsafe/.test(e(t,r))})),r.join("")}}]}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var r=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,i=/^mailto:/;return function(o,a){function s(e){e&&g.push(n(e))}function c(e,r){g.push("<a "),t.isDefined(a)&&(g.push('target="'),g.push(a),g.push('" ')),g.push('href="'),g.push(e),g.push('">'),s(r),g.push("</a>")}if(!o)return o;for(var u,l,f,d=o,g=[];u=d.match(r);)l=u[0],u[2]==u[3]&&(l="mailto:"+l),f=u.index,s(d.substr(0,f)),c(l,u[0].replace(i,"")),d=d.substring(f+u[0].length);return s(d),e(g.join(""))}}])}(window,window.angular);var mod;mod=angular.module("infinite-scroll",[]),mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(e,t,r){return{link:function(n,i,o){var a,s,c,u;return t=angular.element(t),c=0,null!=o.infiniteScrollDistance&&n.$watch(o.infiniteScrollDistance,function(e){return c=parseInt(e,10)}),u=!0,a=!1,null!=o.infiniteScrollDisabled&&n.$watch(o.infiniteScrollDisabled,function(e){return u=!e,u&&a?(a=!1,s()):void 0}),s=function(){var r,s,l,f;return f=t.height()+t.scrollTop(),r=i.offset().top+i.height(),s=r-f,l=t.height()*c>=s,l&&u?e.$$phase?n.$eval(o.infiniteScroll):n.$apply(o.infiniteScroll):l?a=!0:void 0},t.on("scroll",s),n.$on("$destroy",function(){return t.off("scroll",s)}),r(function(){return o.infiniteScrollImmediateCheck?n.$eval(o.infiniteScrollImmediateCheck)?s():void 0:s()},0)}}}]),function(){"use strict";var e=angular.module("LocalStorageModule",[]);e.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){this.prefix=e},this.setStorageType=function(e){this.storageType=e},this.setStorageCookie=function(e,t){this.cookie={expiry:e,path:t}},this.setStorageCookieDomain=function(e){this.cookie.domain=e},this.setNotify=function(e,t){this.notify={setItem:e,removeItem:t}},this.$get=["$rootScope","$window","$document",function(e,t,r){var n,i=this.prefix,o=this.cookie,a=this.notify,s=this.storageType;r||(r=document),"."!==i.substr(-1)&&(i=i?i+".":"");var c=function(e){return i+e},u=function(){try{var r=s in t&&null!==t[s],i=c("__"+Math.round(1e7*Math.random()));return r&&(n=t[s],n.setItem(i,""),n.removeItem(i)),r}catch(o){return s="cookie",e.$broadcast("LocalStorageModule.notification.error",o.message),!1}}(),l=function(t,r){if(!u)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),a.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:r,storageType:"cookie"}),m(t,r);"undefined"==typeof r&&(r=null);try{(angular.isObject(r)||angular.isArray(r))&&(r=angular.toJson(r)),n&&n.setItem(c(t),r),a.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:r,storageType:this.storageType})}catch(i){return e.$broadcast("LocalStorageModule.notification.error",i.message),m(t,r)}return!0},f=function(t){if(!u)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),v(t);var r=n?n.getItem(c(t)):null;return r&&"null"!==r?"{"===r.charAt(0)||"["===r.charAt(0)?angular.fromJson(r):r:null},d=function(t){if(!u)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),a.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:"cookie"}),S(t);try{n.removeItem(c(t)),a.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:this.storageType})}catch(r){return e.$broadcast("LocalStorageModule.notification.error",r.message),S(t)}return!0},g=function(){if(!u)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var t=i.length,r=[];for(var o in n)if(o.substr(0,t)===i)try{r.push(o.substr(t))}catch(a){return e.$broadcast("LocalStorageModule.notification.error",a.Description),[]}return r},p=function(t){t=t||"";var r=i.slice(0,-1),o=new RegExp(r+"."+t);if(!u)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),y();var a=i.length;for(var s in n)if(o.test(s))try{d(s.substr(a))}catch(c){return e.$broadcast("LocalStorageModule.notification.error",c.message),y()}return!0},h=function(){try{return navigator.cookieEnabled||"cookie"in r&&(r.cookie.length>0||(r.cookie="test").indexOf.call(r.cookie,"test")>-1)}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}},m=function(t,n){if("undefined"==typeof n)return!1;if(!h())return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var i="",a=new Date,s="";if(null===n?(a.setTime(a.getTime()+-864e5),i="; expires="+a.toGMTString(),n=""):0!==o.expiry&&(a.setTime(a.getTime()+24*o.expiry*60*60*1e3),i="; expires="+a.toGMTString()),t){var u="; path="+o.path;o.domain&&(s="; domain="+o.domain),r.cookie=c(t)+"="+encodeURIComponent(n)+i+u+s}}catch(l){return e.$broadcast("LocalStorageModule.notification.error",l.message),!1}return!0},v=function(t){if(!h())return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var n=r.cookie&&r.cookie.split(";")||[],o=0;o<n.length;o++){for(var a=n[o];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(c(t)+"="))return decodeURIComponent(a.substring(i.length+t.length+1,a.length))}return null},S=function(e){m(e,null)},y=function(){for(var e=null,t=i.length,n=r.cookie.split(";"),o=0;o<n.length;o++){for(e=n[o];" "===e.charAt(0);)e=e.substring(1,e.length);var a=e.substring(t,e.indexOf("="));S(a)}},b=function(){return s},w=function(e,t,r){var n=f(t);null===n&&angular.isDefined(r)?n=r:angular.isObject(n)&&angular.isObject(r)&&(n=angular.extend(r,n)),e[t]=n,e.$watchCollection(t,function(e){l(t,e)})};return{isSupported:u,getStorageType:b,set:l,add:l,get:f,keys:g,remove:d,clearAll:p,bind:w,deriveKey:c,cookie:{set:m,add:m,get:v,remove:S,clearAll:y}}}]})}.call(this),function(e,t){angular.module("iso.config",[]).value("iso.config",{debug:!0}),angular.module("iso.directives",["iso.services"]),angular.module("iso.services",[]),angular.module("iso",["iso.config","iso.directives","iso.services"]),angular.module("iso.controllers",["iso.config","iso.services"]).controller("angularIsotopeController",["iso.config","iso.topics","$scope","$timeout","optionsStore",function(t,r,n,i,o){"use strict";var a,s,c,u,l,f,d,g,p;f="isotope.onLayout",g=!1,u=null,a=[],p="",c="",n.$on(f,function(e){}),n.layoutEventEmit=function(e,t){return i(function(){return n.$apply(function(){return n.$emit(f)})})},o.store({onLayout:n.layoutEventEmit}),s=function(e,t,r){return t?e.call(n,t,r):void 0},n.delayInit=function(e){o.storeInit(e)},n.delayedInit=function(){var e=o.retrieveInit();n.init(e)},n.$on("iso-init",function(){n.delayedInit()}),n.init=function(t){return o.storeInit(t),u=t.element,s(n.$on,t.isoOptionsEvent||r.MSG_OPTIONS,d),s(n.$on,t.isoMethodEvent||r.MSG_METHOD,l),n.isoMode=t.isoMode||"addItems",i(function(){var t=o.retrieve();if(!e.jQuery||!u.isotope(t)){var r=new Isotope(u[0],t);u.isotope=function(e,t){var n=Array.prototype.slice.call(arguments,1);return"string"==typeof e?r[e].apply(r,n):(r.option(e),void r._init(t))}}g=!0})},n.setIsoElement=function(e){return g?i(function(){return u.isotope(n.isoMode,e)}):void 0},n.refreshIso=function(){return g?u.isotope():void 0},n.updateOptions=function(e){u?u.isotope(e):o.store(e)},n.updateMethod=function(e,t,r){return u.isotope(e,t,r)},d=function(e,t){return n.updateOptions(t)},l=function(e,t){var r,i;return r=t.name,i=t.params,n.updateMethod(r,i,null)},n.removeAll=function(e){return u.isotope("remove",u.data("isotope").$allAtoms,e)},n.refresh=function(){return u.isotope()},n.$on(t.refreshEvent,function(){return n.refreshIso()}),n.$on(r.MSG_REMOVE,function(e,t){return n.removeElement(t)}),n.$on(r.MSG_OPTIONS,function(e,t){return d(e,t)}),n.$on(r.MSG_METHOD,function(e,t){return l(e,t)}),n.removeElement=function(e){return u&&u.isotope("remove",e)}}]).controller("isoSortByDataController",["iso.config","$scope","optionsStore",function(e,t,r){var n,i;t.getHash=function(e){return"opt"+e},t.storeMethods=function(e){return r.store({getSortData:e})},t.optSortData=function(e,r){var i,o,a,s,c,u,l;return o={},i=angular.element(r),c=i.attr("ok-sel"),l=i.attr("ok-type"),u=t.getHash(c),a=i.attr("opt-convert")?eval_("["+i.attr("opt-convert")+"]")[0]:null,s=function(e,t,r){return function(i){return n(e,i,t,r)}},o[u]=s(c,l,a),o},t.createSortByDataMethods=function(e){var r,n;return r=$(e),n=i(r.map(t.optSortData))},i=function(e){var t;return t={},angular.forEach(e,function(e,r){return angular.extend(t,e)}),t},n=function(e,t,r,n){var i,o,a,s,c;return i=function(e,t,r){var n;if(!t.length)return e.text();switch(n="",r.charAt(0)){case"#":n=t.text();break;case".":n=t.text();break;case"[":n=t.attr(r.replace("[","").replace("]","").split()[0])}return n},s=function(e,t){var r,n;return r=function(e){return isNaN(e)?Number.POSITIVE_INFINITY:e},n={text:function(e){return e.toString()},integer:function(e){return r(parseInt(e,10))},"float":function(e){return r(parseFloat(e))},"boolean":function(e){return"true"===e}},n[t]?n[t](e):e},o=t.find(e),a=i(t,o,e),c=s(a,r),n?n(c):c}}]),angular.module("iso.directives",["iso.config","iso.services","iso.controllers"]),angular.module("iso.directives").directive("isotopeContainer",["$injector","$parse",function(e,t){"use strict";var r;return r={},{controller:"angularIsotopeController",link:function(e,r,n){var i,o,a;return a=[],o=n.isoOptions,i={},o&&(a=t(o)(e),angular.isObject(a)&&e.updateOptions(a)),i.element=r,i.isoOptionsEvent=n.isoOptionsSubscribe,i.isoMethodEvent=n.isoMethodSubscribe,i.isoMode=n.isoMode,"true"===n.isoUseInitEvent?e.delayInit(i):e.init(i),r}}}]).directive("isotopeItem",["$rootScope","iso.config","iso.topics","$timeout",function(e,t,r,n){return{restrict:"A",require:"^isotopeContainer",link:function(i,o,a){return i.setIsoElement(o),i.$on("$destroy",function(t){e.$broadcast(r.MSG_REMOVE,o)}),a.ngRepeat&&!0===i.$last&&"addItems"===i.isoMode&&o.ready(function(){return n(function(){return i.refreshIso()},t.refreshDelay||0)}),a.ngRepeat||o.ready(function(){return n(function(){return i.refreshIso()},t.refreshDelay||0)}),o}}}]).directive("isoSortbyData",function(){return{restrict:"A",controller:"isoSortByDataController",link:function(e,t,r){var n,i,o,a,s,c;return s=angular.element(t),a=s.attr("ok-key"),o="iso-opts",c={},n=s.find("[ok-sel]"),n.each(function(t){var r;return r=angular.element(this),r.attr("ok-sortby-key",e.getHash(r.attr("ok-sel")))}),i=e.createSortByDataMethods(n),e.storeMethods(i)}}}).directive("optKind",["optionsStore","iso.topics",function(e,t){return{restrict:"A",controller:"isoSortByDataController",link:function(r,n,i){var o,a,s,c,u,l,f,d,g,p,h;if(d=$(n),l=i.okPublish||i.okOptionsPublish||t.MSG_OPTIONS,f=i.okMethodPublish||t.MSG_METHOD,u=d.attr("ok-key"),determineActiveClass=function(){g=i.okActiveClass,g||(g=d.find(".selected").length?"selected":"active"),p="."+g,h=d.find(p)},o=function(e){var t,n,i,o;return i=e.attr("ok-key"),"sortBy"===i?(o={},t=e.find("[ok-sel]"),t.each(function(e){var t;return t=angular.element(this),t.attr("ok-sortby-key",r.getHash(t.attr("ok-sel")))}),n=r.createSortByDataMethods(t),r.storeMethods(n)):void 0},a=function(e){var t,r,n,i;return e?(n={},i=e.attr("ok-sortby-key"),t=e.attr("opt-ascending"),r=i||e.attr("ok-sel"),i&&(n.sortAscending=t?"true"===t:!0),n[u]=r,n):void 0},c=function(t){return e.store(t),r.$emit(l,t)},s=function(e){var t;return e.preventDefault(),t=angular.element(e.target),t.hasClass(g)?!1:(d.find(p).removeClass(g),t.addClass(g),c(a(t)),!1)},determineActiveClass(),o(d),h.length){var m=a(h);e.store(m)}return d.on("click",function(e){return s(e)})}}}]),angular.module("iso.services",["iso.config"],["$provide",function(e){return e.factory("optionsStore",["iso.config",function(e){"use strict";var t,r;return t=e.defaultOptions||{},{store:function(e){return angular.extend(t,e),t},retrieve:function(){return t},storeInit:function(e){r=e},retrieveInit:function(){return r}}}])}]).value("iso.topics",{MSG_OPTIONS:"iso-option",MSG_METHOD:"iso-method",MSG_REMOVE:"iso-remove"})}(window,document),!function(e,t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof exports?module.exports=t():e.Autolinker=t()}(this,function(){var e=function(t){e.Util.assign(this,t)};return e.prototype={constructor:e,urls:!0,email:!0,twitter:!0,newWindow:!0,stripPrefix:!0,className:"",htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;)/gi,matcherRegex:function(){var e=/(^|[^\w])@(\w{1,15})/,t=/(?:[\-;:&=\+\$,\w\.]+@)/,r=/(?:[A-Za-z]{3,9}:(?:\/\/)?)/,n=/(?:www\.)/,i=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,o=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,a=/(?:[\-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|])?/;return new RegExp(["(",e.source,")","|","(",t.source,i.source,o.source,")","|","(","(?:","(?:",r.source,i.source,")","|","(?:","(.?//)?",n.source,i.source,")","|","(?:","(.?//)?",i.source,o.source,")",")",a.source,")"].join(""),"gi")}(),invalidProtocolRelMatchRegex:/^[\w]\/\//,charBeforeProtocolRelMatchRegex:/^(.)?\/\//,link:function(t){var r=this,n=this.getHtmlParser(),i=this.htmlCharacterEntitiesRegex,o=0,a=[];return n.parse(t,{processHtmlNode:function(e,t,r){"a"===t&&(r?o=Math.max(o-1,0):o++),a.push(e)},processTextNode:function(t){if(0===o)for(var n=e.Util.splitAndCapture(t,i),s=0,c=n.length;c>s;s++){var u=n[s],l=r.processTextNode(u);a.push(l)}else a.push(t)}}),a.join("")},getHtmlParser:function(){var t=this.htmlParser;return t||(t=this.htmlParser=new e.HtmlParser),t},getTagBuilder:function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new e.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t},processTextNode:function(t){var r=this,n=this.charBeforeProtocolRelMatchRegex;return t.replace(this.matcherRegex,function(t,i,o,a,s,c,u,l){var f,d=i,g=o,p=a,h=s,m=c,v=u||l,S="",y="";if(!r.isValidMatch(d,h,m,v))return t;if(r.matchHasUnbalancedClosingParen(t)&&(t=t.substr(0,t.length-1),y=")"),h)f=new e.match.Email({matchedText:t,email:h});else if(d)g&&(S=g,t=t.slice(1)),f=new e.match.Twitter({matchedText:t,twitterHandle:p});else{if(v){var b=v.match(n)[1]||"";b&&(S=b,t=t.slice(1))}f=new e.match.Url({matchedText:t,url:t,protocolRelativeMatch:v,stripPrefix:r.stripPrefix})}var w=r.createMatchReturnVal(f,t);return S+w+y})},isValidMatch:function(e,t,r,n){return e&&!this.twitter||t&&!this.email||r&&!this.urls||r&&-1===r.indexOf(".")||r&&/^[A-Za-z]{3,9}:/.test(r)&&!/:.*?[A-Za-z]/.test(r)||n&&this.invalidProtocolRelMatchRegex.test(n)?!1:!0},matchHasUnbalancedClosingParen:function(e){var t=e.charAt(e.length-1);if(")"===t){var r=e.match(/\(/g),n=e.match(/\)/g),i=r&&r.length||0,o=n&&n.length||0;if(o>i)return!0}return!1},createMatchReturnVal:function(t,r){var n;if(this.replaceFn&&(n=this.replaceFn.call(this,this,t)),"string"==typeof n)return n;if(n===!1)return r;if(n instanceof e.HtmlTag)return n.toString();var i=this.getTagBuilder(),o=i.build(t);return o.toString()}},e.link=function(t,r){var n=new e(r);return n.link(t)},e.match={},e.Util={abstractMethod:function(){throw"abstract"},assign:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},extend:function(t,r){var n=t.prototype,i=function(){};i.prototype=n;var o;o=r.hasOwnProperty("constructor")?r.constructor:function(){n.constructor.apply(this,arguments)};var a=o.prototype=new i;return a.constructor=o,a.superclass=n,delete r.constructor,e.Util.assign(a,r),o},ellipsis:function(e,t,r){return e.length>t&&(r=null==r?"..":r,e=e.substring(0,t-r.length)+r),e},indexOf:function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var r=0,n=e.length;n>r;r++)if(e[r]===t)return r;return-1},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,n=[],i=0;r=t.exec(e);)n.push(e.substring(i,r.index)),n.push(r[0]),i=r.index+r[0].length;return n.push(e.substring(i)),n}},e.HtmlParser=e.Util.extend(Object,{htmlRegex:function(){var e=/[0-9a-zA-Z:]+/,t=/[^\s\0"'>\/=\x01-\x1F\x7F]+/,r=/(?:".*?"|'.*?'|[^'"=<>`\s]+)/,n=t.source+"(?:\\s*=\\s*"+r.source+")?";return new RegExp(["<(?:!|(/))?","("+e.source+")","(?:","\\s+","(?:",n,"|",r.source+")",")*","\\s*/?",">"].join(""),"g")}(),parse:function(e,t){t=t||{};for(var r,n=t.processHtmlNode||function(){},i=t.processTextNode||function(){},o=this.htmlRegex,a=0;null!==(r=o.exec(e));){var s=r[0],c=r[2],u=!!r[1],l=e.substring(a,r.index);l&&i(l),n(s,c,u),a=r.index+s.length}if(a<e.length){var f=e.substring(a);f&&i(f)}}}),e.HtmlTag=e.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(t){e.Util.assign(this,t),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){return this.tagName=e,this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){var r=this.getAttrs();return r[e]=t,this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(t){var r=this.getAttrs();return e.Util.assign(r,t),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(t){for(var r,n=this.getClass(),i=this.whitespaceRegex,o=e.Util.indexOf,a=n?n.split(i):[],s=t.split(i);r=s.shift();)-1===o(a,r)&&a.push(r);return this.getAttrs()["class"]=a.join(" "),this},removeClass:function(t){for(var r,n=this.getClass(),i=this.whitespaceRegex,o=e.Util.indexOf,a=n?n.split(i):[],s=t.split(i);a.length&&(r=s.shift());){var c=o(a,r);-1!==c&&a.splice(c,1)}return this.getAttrs()["class"]=a.join(" "),this},getClass:function(){return this.getAttrs()["class"]||""},hasClass:function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},setInnerHtml:function(e){return this.innerHtml=e,this},getInnerHtml:function(){return this.innerHtml||""},toString:function(){var e=this.getTagName(),t=this.buildAttrsStr();return t=t?" "+t:"",["<",e,t,">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+'="'+e[r]+'"');return t.join(" ")}}),e.AnchorTagBuilder=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},build:function(t){var r=new e.HtmlTag({tagName:"a",attrs:this.createAttrs(t.getType(),t.getAnchorHref()),innerHtml:this.processAnchorText(t.getAnchorText())});return r},createAttrs:function(e,t){var r={href:t},n=this.createCssClass(e);return n&&(r["class"]=n),this.newWindow&&(r.target="_blank"),r},createCssClass:function(e){var t=this.className;return t?t+" "+t+"-"+e:""},processAnchorText:function(e){return e=this.doTruncate(e)},doTruncate:function(t){return e.Util.ellipsis(t,this.truncate||Number.POSITIVE_INFINITY)}}),e.match.Match=e.Util.extend(Object,{constructor:function(t){e.Util.assign(this,t)},getType:e.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:e.Util.abstractMethod,getAnchorText:e.Util.abstractMethod}),e.match.Email=e.Util.extend(e.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),e.match.Twitter=e.Util.extend(e.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),e.match.Url=e.Util.extend(e.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,checkForProtocolRegex:/^[A-Za-z]{3,9}:/,getType:function(){return"url"},getUrl:function(){var e=this.url;return this.protocolRelativeMatch||this.checkForProtocolRegex.test(e)||(e=this.url="http://"+e),e},getAnchorHref:function(){var e=this.getUrl();return e.replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getUrl();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix&&(e=this.stripUrlPrefix(e)),e=this.removeTrailingSlash(e)},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}}),e});var SircusFeedViewerApp=angular.module("SircusFeedViewer",["LocalStorageModule","infinite-scroll","ngSanitize","iso.directives"]);SircusFeedViewerApp.config(["localStorageServiceProvider",function(e){e.setPrefix("sircus-viewer")}]),SircusFeedViewerApp.run(["$rootScope","SircusFeedLocalizedDataService",function(e,t){var r=[];r=angular.isUndefined(sircus_data)||null===sircus_data?[]:sircus_data,t.init(r),e.dataService=t}]),SircusFeedViewerApp.filter("i18n",["SircusFeedI18nService",function(e){return function(t){return e.has(t)?e.get(t):t}}]),SircusFeedViewerApp.filter("imageuri",["SircusFeedUrlService",function(e){return function(t){return e.getPluginUrl("/images/"+t)}}]),angular.module("SircusFeedViewer").service("isotopeService",function(){return{trigger:function(e){e.$emit("iso-option",{layoutMode:"masonry",itemSelector:"article.social-tile",transitionDuration:0,sortBy:"original-order"})}}}),SircusFeedViewerApp.service("SircusFeedApiRequestService",["$http","$log","localStorageService","SircusFeedLocalizedDataService","SircusFeedTransformRequestService",function(e,t,r,n,i){function o(e,t){return angular.isUndefined(e)||null===e?!1:angular.isUndefined(t)||null===t?!1:n.get("api_url")+"/"+e+"/"+t}function a(){return n.get("api_key")}function s(t,r){var n=o(t,r);if(!n)return!1;var s=e({method:"POST",url:o(t,r),data:{api_token:a()},transformRequest:function(e){return i.transformRequest(e)},headers:{"Content-Type":"application/x-www-form-urlencoded"}});return s.then(g,d)}function c(e){s(e,"like")}function u(e){s(e,"unlike")}function l(e){s(e,"share")}function f(e){s(e,"open")}function d(e){t.log(e)}function g(e){}return{likeItem:c,unlikeItem:u,shareItem:l,openItem:f}}]),SircusFeedViewerApp.service("SircusFeedApiService",["$http","$log","localStorageService","SircusFeedLocalizedDataService","SircusFeedApiRequestService",function(e,t,r,n,i){function o(e,t,n){t[e]=!0,n&&r.set(e+"-"+t.id,!0)}function a(e,t){var n=r.get(e+"-"+t.id);return t[e]=n,n}function s(e,t,n){t[e]=!1,n&&r.set(e+"-"+t.id,!1)}function c(e){return a("like",e)===!0?!1:(y(e),!0)}function u(e){return b(e),!0}function l(e){return a("share",e)?!1:(w(e),!0)}function f(e){return e.text=e.full_text,d(e)}function d(e){return x(e),!0}function g(e){return e.text=e.mini_text,I(e),!0}function p(e){return 1==e.open?g(e):f(e)}function h(e){return a("viewed",e)?!1:(k(e),!0)}function m(e,t){this[e](t)}function v(e){return"banner"!=e.type&&(a("like",e),a("open",e),a("share",e),a("view",e)),e}function S(e){return null===e||angular.isUndefined(e)||null===e.length||angular.isUndefined(e.length)?null:e.map(function(e){return e=v(e)})}function y(e){e.likes++,o("like",e,!0),i.likeItem(e.id)}function b(e){s("like",e,!0),e.likes=Math.max(e.likes-1,0),i.unlikeItem(e.id)}function w(e){o("share",e,!0),i.shareItem(e.id)}function x(e){o("open",e,!0),i.openItem(e.id)}function I(e){s("open",e,!1)}function k(e){o("viewed",e,!0)}return{like:c,unlike:u,open:f,close:g,toggle:p,view:h,share:l,initItem:v,initItems:S,doAction:m}}]),SircusFeedViewerApp.service("SircusFeedI18nService",["$rootScope","$http","$log","SircusFeedLocalizedDataService",function(e,t,r,n){function i(e){return $i18n=n.get("i18n"),$i18n[e]}function o(e){var t=n.get("i18n");return angular.isUndefined(t)||null===t?!1:angular.isUndefined(t[e])||null===t[e]?!0:!1}return{get:i,has:o}}]),SircusFeedViewerApp.service("SircusFeedLocalizedDataService",["$http","$log",function(e,t){function r(e){a=e}function n(e,t){a[e]=t}function i(e){return angular.isUndefined(a[e])||null===a[e]?!0:!1}function o(e){return a[e]}var a=[];return{init:r,get:o,has:i,set:n}}]),SircusFeedViewerApp.service("SircusFeedScrollService",["$log","$location","$anchorScroll",function(e,t,r){function n(){y={page:0,limit:5,enabled:!0,top:0,height:0,topHash:""},t.hash(y.topHash),r()}function i(){1==g()?d():f()}function o(e){y.top=e}function a(){return y.top}function s(e){y.topHash=e}function c(){return y.topHash}function u(e){y.height=e}function l(){return y.height}function f(){y.enabled=!0}function d(){y.enabled=!1}function g(){return y.enabled}function p(e){y.limit=e}function h(){return y.limit}function m(){y.page++,y.page%h()==0&&d()}function v(){return y.page}function S(){y.page=0}var y={page:0,limit:5,enabled:!0,top:0,height:0,topHash:""};return{resetPage:S,getPage:v,incrementPage:m,getLimit:h,setLimit:p,isEnabled:g,disable:d,enable:f,toggle:i,reset:n,setTop:o,getTop:a,setHeight:u,getHeight:l,getTopHash:c,setTopHash:s}}]),SircusFeedViewerApp.service("SircusFeedService",["$http","$q","$log","SircusFeedLocalizedDataService",function(e,t,r,n){function i(){H=[],H.cursor=!1,H.limit=4,H.waiting=!1,H.finished=!1,H.orderby="rank",H.order="asc",H.tag=!1,H.promise=null,H.requests=0,H.type="list",H.query="",H.page=1,H.total=0}function o(){return H.finished}function a(){return H.waiting}function s(){return H.limit}function c(e){H.limit=e}function u(){return H.orderby}function l(e){H.orderby=e}function f(){return H.order}function d(e){H.order=e}function g(){return H.tag}function p(e){H.tag=e}function h(){return H.cursor}function m(e){H.cursor=e}function v(){return H.total}function S(){return Math.ceil(v()/s())}function y(e){return e==H.cursor}function b(e){H.page=e}function w(){return H.page}function x(e){H.type=e}function I(){return H.type}function k(e){H.query=e}function T(){return H.query}function A(e){return H.waiting=!1,r.log(e),t.reject("Something went wrong")}function F(e){try{return e.data.data}catch(t){return{}}}function O(e){try{return e.data.meta.cursor}catch(t){return H.finished=!0,!1}}function C(e){var t=O(e);y(t)?H.finished=!0:m(t),"undefined"!==e.data.meta.total&&null!==e.data.meta.total&&(H.total=e.data.meta.total)}function P(e){return r.log(e.data),C(e),H.waiting=!1,F(e)}function _(){return"search"==I()?U():M()}function M(){var e={action:"sircus_action_get",type:"list",format:"json",limit:s(),skip_banner:0},t=h();t?e.cursor=t:e.banner=1;var r=g();return r&&(e.tag=g()),e}function U(){var e={action:"sircus_action_get",type:"search",format:"json",limit:s(),start:(w()-1)*s(),query:T(),skip_banner:1};return e}function R(r){if(this.isFinished())return!1;if(this.isWaiting())return!1;H.waiting=!0;var i=t.defer(),o=e({method:"POST",url:n.get("ajax_url"),params:_()});return H.promise=o.then(P,A),H.promise.abort=function(){return i.resolve(),[]},H.promise["finally"](function(){promise.abort=angular.noop,
i=o=promise=null}),H.promise}function E(){return H.promise&&H.promise.abort()}function L(){var e=$.Deferred(),t=setInterval(function(){H.requests++,H.waiting||(clearInterval(t),e.resolve())},1e3);return e.promise()}var H=[];return i(),{ready:L,abort:E,waiting:H.waiting,finished:H.finished,setPage:b,getPage:w,setType:x,getType:I,setQuery:k,getQuery:T,getItems:R,getLimit:s,setLimit:c,getOrderBy:u,setOrderBy:l,getOrder:f,setOrder:d,getTag:g,setTag:p,getTotal:v,getPageCount:S,isFinished:o,isWaiting:a,reset:i,init:i}}]),SircusFeedViewerApp.service("SircusFeedTransformItemDataService",["$log",function(e){function t(e,t){var r={};if((null==t||1>t)&&(t=70),r.id=e.id,e.fields.item_text){var n=e.fields.item_text,a=n.replace("youtube.com/v/","youtube.com/embed/").replace(/(youtube.com.*?\?)(.*)/,"$1showinfo=0&playsinline=1&$2").replace("<iframe",'<iframe width="560" height="315"');r.full_text=Autolinker.link(a,{newWindow:!0});var s=String(e.fields.item_text).replace(i,"").trim(),c=o(s,120),u=c.length<s.length;c=Autolinker.link(c,{newWindow:!0}),u&&(c+="&hellip;"),r.mini_text=c,r.text=r.mini_text}r.source=e.fields.link,r.likes=Math.max(e.fields.like_count,0),r.tags=e.fields.item_tags,r.template=e.fields.item_template,r.service=e.fields.service,r.type=e.fields.type;try{r.media=angular.fromJson(e.fields.item_media)}catch(l){r.media=e.fields.item_media}return 0!=e.fields.item_author?r.author=angular.fromJson(e.fields.item_author):r.author={name:"",id:"",image:""},1==e.fields.featured?r.featured="featured":r.featured="standard","youtube"==e.fields.service&&(r.featured="featured"),"twitter"==e.fields.service&&"text"==e.fields.item_template&&(r.featured="standard"),0!=e.fields.created_ts?r.timestamp=1e3*e.fields.created_ts:r.timestamp=0,r}function r(e){return e.type="banner",e}function n(e,n){return"banner"==e.type?n?r(e):!1:t(e)}var i=/(<([^>]+)>)/gi,o=function(e,t){if(e.length<t)return e;var r=e.substring(0,t),n=e.substring(t).indexOf(" ");return n>=0?e.substring(0,t+n):(lastSpace=r.lastIndexOf(" "))>=0?r.substring(0,lastSpace):r};return{createItem:n}}]),SircusFeedViewerApp.service("SircusFeedTransformRequestService",["$log","localStorageService","SircusFeedLocalizedDataService",function(e,t,r){function n(e){var t=[];for(var r in e)if(e[r]instanceof Array)for(var n in e[r]){var i=e[r][n];for(var o in i)t.push(encodeURIComponent(r)+"["+n+"]["+encodeURIComponent(o)+"]="+encodeURIComponent(i[o]))}else t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")}return{transformRequest:n}}]),SircusFeedViewerApp.service("SircusFeedUrlService",["$log","SircusFeedLocalizedDataService",function(e,t){function r(e){return c("api_url",e)}function n(e){return c("site_url",e)}function i(e){return c("theme_url",e)}function o(e){return c("plugin_url",e)}function a(e){return c("partials_url",e)}function s(e){return c("ajax_url",e)}function c(e,r){return t.get(e)+r}return{getSiteUrl:n,getThemeUrl:i,getPluginUrl:o,getPartialUrl:a,getAjaxUrl:s,getItemsApiUrl:r}}]),angular.module("SircusFeedViewer").filter("stripHtml",function(){return function(e){return String(e).replace(/<[^>]+>/gm,"")}}),angular.module("SircusFeedViewer").service("svgCache",function(){var e={},t={},r={};return{has:function(t){return!!e[t]},setSrc:function(t,r){e[t]=r},getSrc:function(t){return e[t]},load:function(n,o){$.get(n,function(a){var s=$(a).find("svg");if(s.removeAttr("xmlns:a"),e[n]=s.clone(),r[n]=!1,o(s.clone()),t[n])for(i in t[n])t[n][i](s.clone())})}}}),angular.module("SircusFeedViewer").controller("SetCtrl",function(e){e.collapseAll=function(){angular.forEach(e.set.items,function(e,t){e.isExpanded=!1})},e.setItemExpanded=function(t){angular.forEach(e.set.items,function(e,r){e.id!=t.id&&(e.open=!1)})}}),SircusFeedViewerApp.controller("SircusFeedController",["$scope","$sce","$log","$http","SircusFeedService","SircusFeedUrlService","SircusFeedLocalizedDataService","SircusFeedI18nService","SircusFeedApiService","SircusFeedTransformItemDataService","SircusFeedLocalizedDataService",function(e,t,r,n,i,o,a,s,c,u,l){e.sets=[],e.args=[],e.limit=a.get("page_limit"),e.feedService=i,e.wait=!1,e.resetItems=function(){e.sets=[]},e.insertItems=function(t){var r={items:[]};t=c.initItems(t),angular.forEach(t,function(e){var t=c.initItem(u.createItem(e,!1));t&&("banner"==t.type?r.banner=t:r.items.push(t))}),e.sets.push(r)},e.renewItems=function(){e.feedService.reset(),e.resetItems(),e.feedService.setLimit(e.limit),e.feedService.setType("search"),e.feedService.setPage(1),e.feedService.setQuery(""),e.wait=!0,e.loadItemsFromFeed()},e.getItems=function(){e.wait=!0,e.feedService.ready().then(function(){e.feedService.isFinished()||(e.feedService.setLimit(e.limit),e.loadItemsFromFeed())})},e.loadItemsFromFeed=function(){e.feedService.getItems().then(function(t){e.insertItems(t),e.wait=!1})},e.feedIsFinished=function(){return e.feedService.isFinished()},e.getItemPartial=function(t){return"banner"==t.type?e.constructBannerPartialUrl(t.display_type):e.constructItemPartialUrl(t.template,t.featured)},e.constructItemPartialUrl=function(e,t){return"featured"===t?o.getPartialUrl("/social-tiles/tile-"+e+"-featured.html"):o.getPartialUrl("/social-tiles/tile-"+e+".html")},e.getClass=function(e){var t=" source-sircus ";if("item"==e.type){e.showOptions&&(t+="show-options ");var r="type-"+e.template,n=e.featured,i="service-"+e.service;"video"==e.template&&(r="type-hybrid type-video"),t+=" source-sircus social-tile hentry "+r+" "+n+" "+i}else t+=" featured-banner-item ";return t},e.renderHtml=function(e){try{return t.trustAsHtml(e)}catch(n){return r.log("scope.renderHtml is unable to parse html code"),""}},e.triggerAction=function(e,t){c.doAction(e,t)},e.init=function(t){e.args=t,t.limit&&(e.limit=t.limit),t.page&&(e.page=t.page),t.page||(e.query=t.query),e.renewItems()}}]),SircusFeedViewerApp.controller("SircusFeedListController",["$scope","$sce","$log","$http","SircusFeedScrollService","SircusFeedService","SircusFeedUrlService","SircusFeedLocalizedDataService","SircusFeedI18nService","SircusFeedApiService","SircusFeedTransformItemDataService","SircusFeedLocalizedDataService","$timeout",function(e,t,r,n,i,o,a,s,c,u,l,f,d){e.sets=[],e.pageColumnCount=3,Responder.query("only screen and (min-width: 1280px)",function(){e.pageColumnCount=4},!0),e.limit=s.get("page_limit"),e.feedService=o,e.wait=!1,e.scroll=i,e.tags=s.get("tags"),e.tag=!1,e.op="list",e.resetTags=function(){e.tags=s.get("tags"),e.tag=!1},e.notBanners=function(e){return"banner"!=e.type},e.changeTag=function(t){e.tags.indexOf(t)>=0&&e.tag!=t?e.tag=t:e.tag=!1,e.renewItems()},e.isCurrentTag=function(t){return t==e.tag},e.resetItems=function(){e.sets=[]},e.setShowOptions=function(e){e.showOptions=!0},e.insertItems=function(t){var r={items:[]};t=u.initItems(t);var n=[];angular.forEach(t,function(e){var t=u.initItem(l.createItem(e,!1));t?n.push(t):r.banner=e});var i=0,o=function(t){return"featured"==t.featured&&e.pageColumnCount>3?2:1},a=function(t,a){for(;i%e.pageColumnCount!=0;){t=(t+1)%a.length;var s=a[t],c=o(s);if(i%e.pageColumnCount+c<=e.pageColumnCount)r.items.push(angular.copy(n[t])),i+=c;else if(t>2*a.length)break}};for(var s in n){var c=n[s],f=o(c);i%e.pageColumnCount+f>e.pageColumnCount&&a(s,n),i+=f,r.items.push(c),s==n.length-1&&a(s,n)}e.sets.push(r)},e.renewItems=function(){e.scroll.reset(),e.feedService.reset(),e.resetItems(),e.feedService.setTag(e.tag),e.feedService.setLimit(e.limit),e.wait=!0,e.loadItemsFromFeed()},e.getItems=function(){e.wait=!0,e.feedService.ready().then(function(){e.feedService.isFinished()||(e.feedService.setLimit(e.limit),e.loadItemsFromFeed())})},e.loadItemsFromFeed=function(){e.feedService.getItems().then(function(t){e.scroll.incrementPage(),e.insertItems(t),e.wait=!1})},e.loadMore=function(){e.scroll.enable(),e.getItems()},e.feedIsFinished=function(){return e.feedService.isFinished()},e.getBannerImageClass=function(e){return e.thumb_url?"":"placeholder"},e.getBannerImageStyle=function(e){return e.thumb_url?"background-image: url("+e.thumb_url+")":"background-image: url("+e.theme_dir+"/img/icons/i_about-us.svg)"},e.constructBannerPartialUrl=function(e){return a.getPartialUrl("/banners/banner-"+e+".html")},e.getItemPartial=function(t){return"banner"==t.type?e.constructBannerPartialUrl(t.display_type):e.constructItemPartialUrl(t.template,t.featured)},e.constructItemPartialUrl=function(e,t,r){return"featured"===t?a.getPartialUrl("/social-tiles/tile-"+e+"-featured.html"):a.getPartialUrl("/social-tiles/tile-"+e+".html")},e.getClass=function(e){var t=" source-sircus ";if("item"==e.type){e.showOptions&&(t+="show-options ");var r="type-"+e.template,n=e.featured,i="service-"+e.service;"video"==e.template&&(r="type-hybrid type-video"),t+=" source-sircus social-tile hentry "+r+" "+n+" "+i}else t+=" featured-banner-item ";return t},e.renderHtml=function(e){try{return t.trustAsHtml(e)}catch(r){return e}},e.triggerAction=function(e,t){u.doAction(e,t)},e.init=function(t){e.args=t,e.renewItems()}}]),angular.module("SircusFeedViewer").filter("limitTile",function(){return function(e,t){if(console.log("limit tile",e),e.length<t)return e;var r=(""+e).substring(t).indexOf(" ");return e.substring(0,t+r)}}),SircusFeedViewerApp.controller("SircusFeedSearchController",["$scope","$sce","$log","$http","SircusFeedService","SircusFeedUrlService","SircusFeedLocalizedDataService","SircusFeedI18nService","SircusFeedApiService","SircusFeedTransformItemDataService","SircusFeedLocalizedDataService",function(e,t,r,n,i,o,a,s,c,u,l){e.items=[],e.args=[],e.limit=a.get("page_limit"),e.feedService=i,e.urlService=o,e.dataService=a,e.wait=!1,e.op="search",e.resetItems=function(){e.items=[]},e.hasNoItems=function(){return e.items.length<1&&0==e.wait},e.getPagesArray=function(){for(var t=[],r=1;r<=e.feedService.getPageCount();r++)t.push(r);return t},e.getPaginationUrl=function(t){var r=a.get("site_url")+"?"+a.get("search_query_var")+"="+e.query+"&"+a.get("domain_query_var")+"=social&"+a.get("domain_page_query_var")+"="+t;return r},e.insertItems=function(t){t=c.initItems(t),angular.forEach(t,function(t){var r=c.initItem(u.createItem(t,!1));r&&e.items.push(r)})},e.renewItems=function(){e.feedService.reset(),e.resetItems(),e.feedService.setLimit(e.limit),e.feedService.setType("search"),e.feedService.setPage(e.page),e.feedService.setQuery(e.query),e.wait=!0,e.loadItemsFromFeed()},e.getItems=function(){e.wait=!0,e.feedService.ready().then(function(){e.feedService.isFinished()||(e.feedService.setLimit(e.limit),e.loadItemsFromFeed())})},e.loadItemsFromFeed=function(){e.feedService.getItems().then(function(t){e.insertItems(t),e.wait=!1})},e.feedIsFinished=function(){return e.feedService.isFinished()},e.getItemPartial=function(t){return"banner"==t.type?e.constructBannerPartialUrl(t.display_type):e.constructItemPartialUrl(t.template,t.featured)},e.constructItemPartialUrl=function(e,t){return"featured"===t?o.getPartialUrl("/social-tiles/tile-"+e+"-featured.html"):o.getPartialUrl("/social-tiles/tile-"+e+".html")},e.getPaginationPartial=function(){return o.getPartialUrl("/pagination/links.html")},e.getClass=function(e){var t=" source-sircus ";if("item"==e.type){var r="type-"+e.template,n=e.featured,i="service-"+e.service;"video"==e.template&&(r="type-hybrid type-video"),t+=" source-sircus social-tile hentry "+r+" "+n+" "+i}else t+=" featured-banner-item ";return t},e.renderHtml=function(e){try{return t.trustAsHtml(e)}catch(n){return r.log("renderHtml is unable to parse html code"),e}},e.triggerAction=function(e,t){c.doAction(e,t)},e.init=function(t){e.args=t,angular.isObject(t)&&t.limit>0?e.limit=t.limit:e.limit=a.get("limit"),angular.isObject(t)&&t.page>0?e.page=t.page:e.page=a.get("page"),angular.isObject(t)&&t.query?e.query=t.query:e.query=a.get("query"),e.renewItems()}}]),angular.module("SircusFeedViewer").directive("randomTweetColors",function(){}),SircusFeedViewerApp.directive("itemBackground",["$log",function(e){var t=["#194685","#799ED2","#C7202C","#5C8A3D","#2EBAA5","#038798","#EF4E22"];return function(e,r,n){if(e.item){var i=!1;"item"==e.item.type&&(i="video"==e.item.template?e.item.media.thumbnail:e.item.media,"text"==e.item.template&&r.css("background-color",t[~~(Math.random()*t.length)])),i&&r.css({"background-image":"url("+i+")","background-size":"cover"})}}}]),SircusFeedViewerApp.directive("postRender",["$log","$timeout","isotopeService",function(e,t,r){return{restrict:"A",link:function(e,n,i){if(e.item.open=!1,e.$last){var o=imagesLoaded(n.parent());o.on("always",function(i){t(function(){SocialFeedLib.init(n.parent(),function(n){t(function(){r.trigger(e)},0)}),$(".preloader").fadeOut()},500)})}}}}]),SircusFeedViewerApp.directive("whenScrolled",["$log",function(e){return{link:function(e,t,r){if(null!=e.scroll&&void 0!==e.scroll){var n=jQuery("div.st-content");e.scroll.reset(),e.scroll.setTop(n.scrollTop()),n.scroll(function(){if(!e.wait&&e.scroll.isEnabled()&&!e.feedService.isFinished()){var t=(jQuery("section.social-grid"),jQuery("section.social-grid article")),r=t.last(),i=r.height(),o=r.position();if(null!=o&&void 0!==o){var a=o.top;e.scroll.getHeight()>i&&e.scroll.setTop(n.scrollTop()),e.scroll.getTop()>n.scrollTop()||(e.scroll.setHeight(i),e.scroll.setTop(n.scrollTop()),e.scroll.getTop()+n.height()>a-2*i&&e.getItems())}}})}}}}]),angular.module("SircusFeedViewer").directive("svg",function(e){return{template:function(e,t){return'<img src="'+t.svg+'" />'},link:function(t,r,n){var i=n["class"]?n["class"]:"",o=function(t){if(t){var o=function(e){try{e.attr("class",i+" "+(n.svgClass?n.svgClass:"svg")),n.setFill&&e.children("path").each(function(e,t){jQuery(t).attr("fill",n.setFill)}),r.children().remove(),r.append(e)}catch(t){console.error(t)}};e.load(t,o)}};return n["static"]?void o(n["static"]):n.evaluated?void o(t.$eval(n.evaluated)):(t.$watch(n.svg,function(e,t){o(e)},!0),void o(t.$eval(n.svg)))}}});var SocialFeedLib=function(e,t){function r(t,r){r(!0),e(window).width()>=960?n(t,r):i(t,r)}function n(t,r){t.find(".expand");t.find("article.expanded").removeClass("expanded"),t.on("click","article .expand",function(){var r=e(".st-content"),n=(e(this).parent().outerWidth(),e(this).parent().outerHeight()),i=e(this).offset().top,o=(t.find("article.expanded").outerWidth(),e(this).parent().parent());if(sectionBottom=o.outerHeight()+o.offset().top,articleBottom=n+i,e(window).width()>=960){var a=e("#social-grid-section").width(),s=Math.round(e(this).parent().position().left),c=Math.round(e(this).parent().position().top),u=e(this).parent().hasClass("featured")?"featured":"";articleBottom>=sectionBottom?c-=n:r.scrollTo(e(this).parent(),1e3,{easing:"easeInOutCubic"}),e(window).width()>1280?positionLimit=.75:positionLimit=2/3,s>=Math.round(a*positionLimit)?e(this).parent().css({top:c,right:0}):e(this).parent().css({top:c,left:s}),e(this).parent().after('<div class="social-tile social-placeholder '+u+'">'),e(this).parent().hasClass("expanded")?(e(this).parent().removeClass("expanded"),e(this).parent().css({top:"",left:"",right:""}),e(".social-placeholder").remove()):(t.find("article.expanded").removeClass("expanded").css({top:"",left:"",right:""}).next(".social-placeholder").remove(),e(this).parent().addClass("expanded"))}return!1})}function i(t,r){var n=t.find(".expand");n.magnificPopup({type:"inline",alignTop:!0,fixedContentPos:!0,disableOn:function(){return e(window).width()>=960?!1:!0},callbacks:{open:function(){e(".mfp-wrap").css("overflow-y","hidden"),e(".mfp-content article").css({top:0,left:0,height:""})},close:function(){}}})}function o(t){var r=t.find("article.social-tile"),n=r.not(".featured").not(".expanded").outerWidth();r.not(".featured").not(".expanded").each(function(t,r){e(this).outerWidth()<n&&(n=e(this).outerWidth())}),r.each(function(){e(this).css("height",n)})}return{init:r,initDesktopSocialExpand:n,initMobileSocialExpand:i,initSocialTileAspectRatio:o}}(jQuery,Responder);